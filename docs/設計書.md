---
puppeteer:
  displayHeaderFooter: true
  headerTemplate: "<div style='font-size: 10px; margin-left: 1cm; width: 100%; text-align: center;'></div>"
  footerTemplate: "<div style='font-size: 10px; margin-left: 1cm; width: 100%; text-align: center;'><span class='pageNumber'></span> / <span class='totalPages'></span></div>"
---

<!-- ---
output: word_document
--- -->

<h1>目次</h1>

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1. システム構成](#1-システム構成)
- [2. 機能一覧](#2-機能一覧)
- [3. インターフェース設計](#3-インターフェース設計)
  - [3.1. 画面インターフェース](#31-画面インターフェース)
    - [3.1.1. ユーザー認証](#311-ユーザー認証)
    - [3.1.2. ナビゲーション](#312-ナビゲーション)
    - [3.1.3. ホーム](#313-ホーム)
    - [3.1.4. 業務日報一覧](#314-業務日報一覧)
    - [3.1.5. 業務日報作成](#315-業務日報作成)
    - [3.1.6. 業務日報編集](#316-業務日報編集)
    - [3.1.7. 業務日報明細作成](#317-業務日報明細作成)
    - [3.1.8. 業務日報明細編集](#318-業務日報明細編集)
    - [3.1.9. 業務日報明細一覧](#319-業務日報明細一覧)
    - [3.1.10. 業務処理簿一覧](#3110-業務処理簿一覧)
    - [3.1.11. 業務処理簿作成](#3111-業務処理簿作成)
    - [3.1.12. 業務処理簿編集](#3112-業務処理簿編集)
    - [3.1.13. 目標一覧](#3113-目標一覧)
    - [3.1.14. 目標作成](#3114-目標作成)
    - [3.1.15. 目標編集](#3115-目標編集)
    - [3.1.16. 全体進捗状況](#3116-全体進捗状況)
    - [3.1.17. 個社別進捗状況](#3117-個社別進捗状況)
  - [3.2. 帳票インターフェース](#32-帳票インターフェース)
- [4. データ設計](#4-データ設計)
  - [4.1. テーブル](#41-テーブル)
  - [4.2. ファイル](#42-ファイル)
    - [4.2.1. 全体進捗状況CSVファイル](#421-全体進捗状況csvファイル)
    - [4.2.2. 個社別進捗状況CSVファイル](#422-個社別進捗状況csvファイル)

<!-- /code_chunk_output -->

<!-- pagebreak -->

# 1. システム構成

# 2. 機能一覧

<!-- pagebreak -->

# 3. インターフェース設計

## 3.1. 画面インターフェース

### 3.1.1. ユーザー認証

BASIC認証によるユーザー認証を実装する。
ログインに成功したら、システム内にユーザーIDを保管する。

### 3.1.2. ナビゲーション

**_画面遷移図_**

サービス仕様書参照。以降同様。

### 3.1.3. ホーム

**_画面イメージ_**

サービス仕様書参照。以降同様。

### 3.1.4. 業務日報一覧

**_入力項目_**

|  種別  | 論理名     | 物理名                   | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :----------------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id                  | 数値   |                        | ログインユーザーのユーザーID     |
| CONFIG | ページ件数 | page_size                | 数値   |                        | リストのページ件数               |
| CONFIG | 週開始曜日 | week_day_start           | 数値   |                        | 週の開始曜日(0=日曜日)           |
| PARAMS | 報告開始日 | filter_report_date_start | 日付   | 実行日の属する週の初日 | リストのフィルター条件           |
| PARAMS | 報告終了日 | filter_report_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 報告内容   | filter_report_content    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 作成者     | filter_report_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | ページ番号 | page_number              | 数値   | 1                      | リストのページ番号               |

**_処理内容_**

ユーザーID、フィルター条件に該当する業務日報を取得する。
フィルター項目間は、AND条件とする。
業務日報は、ページ番号・ページ件数を元に取得する。
リストは報告日、作成者の昇順とする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名           | 型     | 特記             | 内容                |
| :----- | :----------- | :--------------- | :----- | :--------------- | :------------------ |
| FORM   | 開始日       | filter_start     | 日付   |                  | 入力項目            |
| FORM   | 終了日       | filter_end       | 日付   |                  | 入力項目            |
| FORM   | サマリー     | filter_summary   | 文字列 |                  | 入力項目            |
| FORM   | 作成者       | filter_creater   | 文字列 |                  | 入力項目            |
| BUTTON | 絞り込み     | button_filer     |        |                  |                     |
| BUTTON | リセット     | button_reset     |        |                  |                     |
| LINK   | 報告日       | date             | 文字列 | 書式：YYYY-mm-dd | 業務日報の項目      |
| DISP   | サマリー     | summary          | 文字列 |                  | 業務日報の項目      |
| DISP   | 作成者       | creater          | 文字列 |                  | 業務日報の項目      |
| DISP   | 開始番号     | page_rec_start   | 整数   |                  | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end     | 整数   |                  | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number | 整数   |                  | レコード件数        |
| LINK   | ページ番号   | page_number      | 整数   |                  | 前後2ページ分を表示 |
| BUTTON | 新規作成     | button_new       |        |                  |                     |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：報告日_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

**_アクション：新規作成_**

遷移先の画面を表示する。

### 3.1.5. 業務日報作成

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 報告開始日 | report_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告終了日 | report_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告内容   | report_content    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | report_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

なし。

**_出力項目_**

| 種別   | 論理名     | 物理名        | 型     | 特記                | 内容                                 |
| :----- | :--------- | :------------ | :----- | :------------------ | :----------------------------------- |
| FORM   | 対象日     | date          | 日付   | 必須。Default:today | システム日付                         |
| FORM   | インポート | import        | CHKBOX | Default:True        | カレンダーからの予定インポートの有無 |
| BUTTON | 作成       | button_create |        |                     |                                      |
| BUTTON | 戻る       | button_back   |        |                     |                                      |

**_アクション：作成_**

業務日報を作成する。
カレンダーに予定が登録されている場合は、各予定を業務日報明細として作成する。
処理後は、遷移先の画面を表示する。

> 以下の場合、遷移先の画面に、作成したデータは含まれない。
>
> - 表示していたフィルター条件、ページ番号に該当しない場合。

> 回避方法：レコード作成の場合は、フィルター、ソート条件をリセットすることで対応する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.6. 業務日報編集

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | 業務日報のID                 |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 報告開始日 | report_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告終了日 | report_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告内容   | report_content    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | report_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

IDに該当する業務日報および業務日報明細を取得する。
リストは全項目でソート可能。デフォルトは開始日時の昇順とする。

**_出力項目_**

| 種別   | 論理名   | 物理名                     | 型     | 特記                   | 内容               |
| :----- | :------- | :------------------------- | :----- | :--------------------- | :----------------- |
| FORM   | 報告日   | report_head_date           | 日付   | 非活性                 | 業務日報の項目     |
| FORM   | 作成者   | report_head_creater        | 文字列 | 非活性                 | 業務日報の項目     |
| FORM   | 業務内容 | report_head_content        | 文字列 |                        | 業務日報の項目     |
| BUTTON | 変更     | button_update              |        |                        |                    |
| BUTTON | 削除     | button_delete              |        |                        |                    |
| BUTTON | 戻る     | button_back                |        |                        |                    |
| BUTTON | 明細追加 | button_new                 |        |                        |                    |
| DISP   | 開始日時 | report_body_datetime_start | 文字列 | 書式：YYYY-mm-dd HH:MM | 業務日報明細の項目 |
| DISP   | 終了日時 | report_body_datetime_end   | 文字列 | 書式：YYYY-mm-dd HH:MM | 業務日報明細の項目 |
| LINK   | 業務名   | report_body_title          | 文字列 |                        | 業務日報明細の項目 |
| DISP   | 関与先   | report_body_company        | 文字列 |                        | 業務日報明細の項目 |
| DISP   | 作成者   | report_creater             | 文字列 |                        | 業務日報明細の項目 |

**_アクション：変更_**

業務日報を更新する。
処理後は、遷移先の画面を表示する。

**_アクション：削除_**

業務日報と業務日報明細を削除する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

**_アクション：明細追加_**

遷移先の画面を表示する。

**_アクション：業務名_**

遷移先の画面を表示する。

### 3.1.7. 業務日報明細作成

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | 業務日報のID                 |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 報告開始日 | report_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告終了日 | report_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告内容   | report_content    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | report_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

> 一覧画面の表示条件は、業務日報編集から業務日報一覧へ戻る際に必要。

**_処理内容_**

なし。

**_出力項目_**

| 種別   | 論理名           | 物理名                      | 型         | 特記   | 内容               |
| :----- | :--------------- | :-------------------------- | :--------- | :----- | :----------------- |
| FORM   | 報告日           | report_head_date            | 日付       | 非活性 | 業務日報の項目     |
| FORM   | 作成者           | report_head_creater         | 文字列     | 非活性 | 業務日報の項目     |
| FORM   | 業務内容         | report_head_content         | 文字列     | 非活性 | 業務日報の項目     |
| FORM   | 開始日時         | report_body_datetime_start  | 日時       | 必須   | 業務日報明細の項目 |
| FORM   | 終了日時         | report_body_datetime_end    | 日時       | 必須   | 業務日報明細の項目 |
| FORM   | 業務名           | report_body_title           | 文字列     | 必須   | 業務日報明細の項目 |
| FORM   | 業務内容         | report_body_description     | 文字列     |        | 業務日報明細の項目 |
| FORM   | 業務区分         | report_body_types           | ブール配列 | 必須   | 業務日報明細の項目 |
| FORM   | 委嘱者           | report_body_company         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 内容             | report_body_outline         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 内容（その他）   | report_body_outline_other   | 文字列     |        | 業務日報明細の項目 |
| FORM   | 対象年度         | report_body_fy_year         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 対象年月         | report_body_fy_month        | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | てん末           | report_body_detail          | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | てん末（その他） | report_body_detail_other    | 文字列     |        | 業務日報明細の項目 |
| FORM   | 処理年月日       | report_body_process_date    | 日付       | 必須   | 業務日報明細の項目 |
| FORM   | 添付ファイル     | report_body_attachment_name | ファイル   |        | 業務日報明細の項目 |
| FORM   | 提出年月日       | report_body_submit_date     | 日付       |        | 業務日報明細の項目 |
| FORM   | 担当税理士       | report_body_taxaccountant   | 外部キー   |        | 業務日報明細の項目 |
| FORM   | 備考             | report_body_note            | 文字列     |        | 業務日報明細の項目 |
| BUTTON | 作成             | button_create               |            |        |                    |
| BUTTON | 戻る             | button_back                 |            |        |                    |

**_アクション：作成_**

業務日報明細を作成する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.8. 業務日報明細編集

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | 業務日報明細のID             |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 報告開始日 | report_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告終了日 | report_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 報告内容   | report_content    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | report_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

> 一覧画面の表示条件は、業務日報編集から業務日報一覧へ戻る際に必要。

**_処理内容_**

IDに該当する業務日報、業務日報明細を取得する。

**_出力項目_**

| 種別   | 論理名           | 物理名                      | 型         | 特記   | 内容               |
| :----- | :--------------- | :-------------------------- | :--------- | :----- | :----------------- |
| FORM   | 報告日           | report_head_date            | 日付       | 非活性 | 業務日報の項目     |
| FORM   | 作成者           | report_head_creater         | 文字列     | 非活性 | 業務日報の項目     |
| FORM   | 業務内容         | report_head_content         | 文字列     | 非活性 | 業務日報の項目     |
| FORM   | 開始日時         | report_body_datetime_start  | 日時       | 必須   | 業務日報明細の項目 |
| FORM   | 終了日時         | report_body_datetime_end    | 日時       | 必須   | 業務日報明細の項目 |
| FORM   | 業務名           | report_body_title           | 文字列     | 必須   | 業務日報明細の項目 |
| FORM   | 業務内容         | report_body_description     | 文字列     |        | 業務日報明細の項目 |
| FORM   | 業務区分         | report_body_types           | ブール配列 | 必須   | 業務日報明細の項目 |
| FORM   | 委嘱者           | report_body_company         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 内容             | report_body_outline         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 内容（その他）   | report_body_outline_other   | 文字列     |        | 業務日報明細の項目 |
| FORM   | 対象年度         | report_body_fy_year         | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | 対象年月         | report_body_fy_month        | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | てん末           | report_body_detail          | 外部キー   | 必須   | 業務日報明細の項目 |
| FORM   | てん末（その他） | report_body_detail_other    | 文字列     |        | 業務日報明細の項目 |
| FORM   | 処理年月日       | report_body_process_date    | 日付       | 必須   | 業務日報明細の項目 |
| FORM   | 添付ファイル     | report_body_attachment_name | ファイル   |        | 業務日報明細の項目 |
| FORM   | 提出年月日       | report_body_submit_date     | 日付       |        | 業務日報明細の項目 |
| FORM   | 担当税理士       | report_body_taxaccountant   | 外部キー   |        | 業務日報明細の項目 |
| FORM   | 備考             | report_body_note            | 文字列     |        | 業務日報明細の項目 |
| BUTTON | 変更             | button_create               |            |        |                    |
| BUTTON | 戻る             | button_back                 |            |        |                    |

**_アクション：変更_**

業務日報明細を更新する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.9. 業務日報明細一覧

**_入力項目_**

|  種別  | 論理名     | 物理名                   | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :----------------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id                  | 数値   |                        | ログインユーザーのユーザーID     |
| CONFIG | ページ件数 | page_size                | 数値   |                        | リストのページ件数               |
| CONFIG | 週開始曜日 | week_day_start           | 数値   |                        | 週の開始曜日(0=日曜日)           |
| PARAMS | 報告開始日 | filter_report_date_start | 日付   | 実行日の属する週の初日 | リストのフィルター条件           |
| PARAMS | 報告終了日 | filter_report_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 業務名     | filter_report_content    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 関与先     | filter_report_company    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 作成者     | filter_report_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | ページ番号 | page_number              | 数値   | 1                      | リストのページ番号               |

**_処理内容_**

ユーザーID、フィルター条件に該当する業務日報明細を取得する。
フィルター項目間は、AND条件とする。
業務日報明細は、ページ番号・ページ件数を元に取得する。
リストは全項目でソート可能。デフォルトは開始日時の昇順とする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名                   | 型     | 特記                   | 内容                |
| :----- | :----------- | :----------------------- | :----- | :--------------------- | :------------------ |
| FORM   | 報告開始日   | filter_report_date_start | 日付   |                        | 入力項目            |
| FORM   | 報告終了日   | filter_report_date_end   | 日付   |                        | 入力項目            |
| FORM   | 業務名       | filter_report_content    | 文字列 |                        | 入力項目            |
| FORM   | 関与先       | filter_report_company    | 文字列 |                        | 入力項目            |
| FORM   | 作成者       | filter_report_creater    | 文字列 |                        | 入力項目            |
| BUTTON | 絞り込み     | button_filer             |        |                        |                     |
| BUTTON | リセット     | button_reset             |        |                        |                     |
| DISP   | 開始日時     | report_datetime_start    | 文字列 | 書式：YYYY-mm-dd MM:DD | 業務日報明細の項目  |
| DISP   | 終了日時     | report_datetime_end      | 文字列 | 書式：YYYY-mm-dd MM:DD | 業務日報明細の項目  |
| LINK   | 業務名       | report_content           | 文字列 |                        | 業務日報明細の項目  |
| DISP   | 関与先       | report_company           | 文字列 |                        | 業務日報明細の項目  |
| DISP   | 作成者       | report_creater           | 文字列 |                        | 業務日報明細の項目  |
| DISP   | 開始番号     | page_rec_start           | 整数   |                        | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end             | 整数   |                        | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number         | 整数   |                        | レコード件数        |
| LINK   | ページ番号   | page_number              | 整数   |                        | 前後2ページ分を表示 |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：業務名_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

### 3.1.10. 業務処理簿一覧

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID     |
| CONFIG | ページ件数 | page_size         | 数値   |                        | リストのページ件数               |
| CONFIG | 週開始曜日 | week_day_start    | 数値   |                        | 週の開始曜日(0=日曜日)           |
| PARAMS | 処理開始日 | filter_date_start | 日付   | 実行日の属する週の初日 | リストのフィルター条件           |
| PARAMS | 処理終了日 | filter_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 委嘱先     | filter_company    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 内容       | filter_outline    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | てん末     | filter_detail     | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | ページ番号 | page_number       | 数値   | 1                      | リストのページ番号               |

**_処理内容_**

ユーザーID、フィルター条件に該当する業務処理簿を取得する。
フィルター項目間は、AND条件とする。
業務処理簿は、ページ番号・ページ件数を元に取得する。
リストは全項目でソート可能。デフォルトは処理年月日の昇順とする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名            | 型     | 特記                   | 内容                |
| :----- | :----------- | :---------------- | :----- | :--------------------- | :------------------ |
| FORM   | 処理開始日   | filter_date_start | 日付   |                        | 入力項目            |
| FORM   | 処理終了日   | filter_date_end   | 日付   |                        | 入力項目            |
| FORM   | 委嘱先       | filter_company    | 文字列 |                        | 入力項目            |
| FORM   | 内容         | filter_outline    | 文字列 |                        | 入力項目            |
| FORM   | てん末       | filter_detail     | 文字列 |                        | 入力項目            |
| FORM   | 作成者       | filter_creater    | 文字列 |                        | 入力項目            |
| BUTTON | 絞り込み     | button_filer      |        |                        |                     |
| BUTTON | リセット     | button_reset      |        |                        |                     |
| BUTTON | 新規作成     | button_new        |        |                        |                     |
| DISP   | 業務区分     | types             | 文字列 |                        | 業務処理簿の項目    |
| DISP   | 委嘱者       | company           | 文字列 |                        | 業務処理簿の項目    |
| LINK   | 内容         | outline           | 文字列 |                        | 業務処理簿の項目    |
| DISP   | てん末       | detail            | 文字列 |                        | 業務処理簿の項目    |
| DISP   | 処理年月日   | process_date      | 文字列 | 書式：YYYY-mm-dd MM:DD | 業務処理簿の項目    |
| DISP   | 作成者       | creater           | 文字列 |                        | 業務処理簿の項目    |
| DISP   | 担当税理士   | taxaccountant     | 文字列 |                        | 業務処理簿の項目    |
| DISP   | 開始番号     | page_rec_start    | 整数   |                        | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end      | 整数   |                        | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number  | 整数   |                        | レコード件数        |
| LINK   | ページ番号   | page_number       | 整数   |                        | 前後2ページ分を表示 |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：新規作成_**

遷移先の画面を表示する。

**_アクション：内容_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

### 3.1.11. 業務処理簿作成

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 処理開始日 | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 処理終了日 | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 委嘱先     | filter_company    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 内容       | filter_outline    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | てん末     | filter_detail     | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

なし。

**_出力項目_**

| 種別   | 論理名                         | 物理名        | 型         | 特記   | 内容             |
| :----- | :----------------------------- | :------------ | :--------- | :----- | :--------------- |
| FORM   | 業務区分                       | types         | 複数選択肢 | 必須   | 業務処理簿の項目 |
| FORM   | 委嘱者                         | company       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 作成者                         | creater       | 選択肢     | 非活性 | 業務処理簿の項目 |
| FORM   | 内容                           | outline       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 内容（その他）                 | outline_other | 文字列     |        | 業務処理簿の項目 |
| FORM   | 対象年度                       | fy_year       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 対象月度                       | fy_month      | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | てん末                         | detail        | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | てん末（その他）               | detail_other  | 文字列     |        | 業務処理簿の項目 |
| FORM   | 処理年月日                     | process_date  | 日付       | 必須   | 業務処理簿の項目 |
| FORM   | 税理士法第３３条の２の添付書面 | attachment    | ファイル   |        | 業務処理簿の項目 |
| FORM   | 税務代理権限書提出日           | submit_date   | 日付       |        | 業務処理簿の項目 |
| FORM   | 担当税理士                     | taxaccountant | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 備考                           | note          | 文字列     |        | 業務処理簿の項目 |
| BUTTON | 作成                           | button_create |            |        |                  |
| BUTTON | 戻る                           | button_back   |            |        |                  |

**_アクション：作成_**

業務処理簿を作成する。
処理後は、遷移先の画面を表示する。

> 以下の場合、遷移先の画面に、作成したデータは含まれない。
>
> - 表示していたフィルター条件、ページ番号に該当しない場合。

> 回避方法：レコード作成の場合は、フィルター、ソート条件をリセットすることで対応する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.12. 業務処理簿編集

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | 業務処理簿のID               |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 処理開始日 | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 処理終了日 | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 委嘱先     | filter_company    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 内容       | filter_outline    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | てん末     | filter_detail     | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

IDに該当する業務処理簿を取得する。

**_出力項目_**

| 種別   | 論理名                         | 物理名        | 型         | 特記   | 内容             |
| :----- | :----------------------------- | :------------ | :--------- | :----- | :--------------- |
| FORM   | 業務区分                       | types         | 複数選択肢 | 必須   | 業務処理簿の項目 |
| FORM   | 委嘱者                         | company       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 作成者                         | creater       | 選択肢     | 非活性 | 業務処理簿の項目 |
| FORM   | 内容                           | outline       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 内容（その他）                 | outline_other | 文字列     |        | 業務処理簿の項目 |
| FORM   | 対象年度                       | fy_year       | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 対象月度                       | fy_month      | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | てん末                         | detail        | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | てん末（その他）               | detail_other  | 文字列     |        | 業務処理簿の項目 |
| FORM   | 処理年月日                     | process_date  | 日付       | 必須   | 業務処理簿の項目 |
| FORM   | 税理士法第３３条の２の添付書面 | attachment    | ファイル   |        | 業務処理簿の項目 |
| FORM   | 税務代理権限書提出日           | submit_date   | 日付       |        | 業務処理簿の項目 |
| FORM   | 担当税理士                     | taxaccountant | 選択肢     | 必須   | 業務処理簿の項目 |
| FORM   | 備考                           | note          | 文字列     |        | 業務処理簿の項目 |
| BUTTON | 変更                           | button_update |            |        |                  |
| BUTTON | 戻る                           | button_back   |            |        |                  |

**_アクション：変更_**

業務処理簿を更新する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.13. 目標一覧

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID     |
| CONFIG | ページ件数 | page_size         | 数値   |                        | リストのページ件数               |
| CONFIG | 週開始曜日 | week_day_start    | 数値   |                        | 週の開始曜日(0=日曜日)           |
| PARAMS | 開始日     | filter_date_start | 日付   | 実行日の属する週の初日 | リストのフィルター条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 関与先     | filter_company    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | ページ番号 | page_number       | 数値   | 1                      | リストのページ番号               |

**_処理内容_**

ユーザーID、フィルター条件に該当する目標を取得する。
フィルター項目間は、AND条件とする。
目標は、ページ番号・ページ件数を元に取得する。
リストは全項目でソート可能。デフォルトは開始日の昇順とする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名            | 型     | 特記             | 内容                |
| :----- | :----------- | :---------------- | :----- | :--------------- | :------------------ |
| FORM   | 開始日       | filter_date_start | 日付   |                  | 入力項目            |
| FORM   | 終了日       | filter_date_end   | 日付   |                  | 入力項目            |
| FORM   | 作成者       | filter_creater    | 文字列 |                  | 入力項目            |
| FORM   | 関与先       | filter_company    | 文字列 |                  | 入力項目            |
| BUTTON | 絞り込み     | button_filer      |        |                  |                     |
| BUTTON | リセット     | button_reset      |        |                  |                     |
| BUTTON | 新規作成     | button_new        |        |                  |                     |
| LINK   | 開始日       | date_start        | 文字列 | 書式：YYYY-mm-dd | 目標の項目          |
| DISP   | 終了日       | date_end          | 文字列 | 書式：YYYY-mm-dd | 目標の項目          |
| DISP   | 作成者       | creater           | 文字列 |                  | 目標の項目          |
| DISP   | 関与先       | company           | 文字列 |                  | 目標の項目          |
| DISP   | 開始番号     | page_rec_start    | 整数   |                  | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end      | 整数   |                  | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number  | 整数   |                  | レコード件数        |
| LINK   | ページ番号   | page_number       | 整数   |                  | 前後2ページ分を表示 |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：新規作成_**

遷移先の画面を表示する。

**_アクション：開始日_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

### 3.1.14. 目標作成

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 開始日     | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 関与先     | filter_company    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

なし。

**_出力項目_**

| 種別   | 論理名   | 物理名        | 型     | 特記   | 内容       |
| :----- | :------- | :------------ | :----- | :----- | :--------- |
| FORM   | 開始日   | date_start    | 日付   | 必須   | 目標の項目 |
| FORM   | 終了日   | date_end      | 日付   | 必須   | 目標の項目 |
| FORM   | 作成者   | creater       | 選択肢 | 非活性 | 目標の項目 |
| FORM   | 関与先   | company       | 選択肢 | 必須   | 目標の項目 |
| FORM   | 時間単価 | unit_price    | 数値   | 必須   | 目標の項目 |
| FORM   | 工数     | man_hour      | 数値   | 必須   | 目標の項目 |
| BUTTON | 作成     | button_create |        |        |            |
| BUTTON | 戻る     | button_back   |        |        |            |

**_アクション：作成_**

目標を作成する。
処理後は、遷移先の画面を表示する。

> 以下の場合、遷移先の画面に、作成したデータは含まれない。
>
> - 表示していたフィルター条件、ページ番号に該当しない場合。

> 回避方法：レコード作成の場合は、フィルター、ソート条件をリセットすることで対応する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.15. 目標編集

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | 目標のID                     |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 開始日     | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 関与先     | filter_company    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

IDに該当する目標を取得する。

**_出力項目_**

| 種別   | 論理名   | 物理名        | 型     | 特記   | 内容       |
| :----- | :------- | :------------ | :----- | :----- | :--------- |
| FORM   | 開始日   | date_start    | 日付   | 必須   | 目標の項目 |
| FORM   | 終了日   | date_end      | 日付   | 必須   | 目標の項目 |
| FORM   | 作成者   | creater       | 選択肢 | 非活性 | 目標の項目 |
| FORM   | 関与先   | company       | 選択肢 | 必須   | 目標の項目 |
| FORM   | 時間単価 | unit_price    | 数値   | 必須   | 目標の項目 |
| FORM   | 工数     | man_hour      | 数値   | 必須   | 目標の項目 |
| BUTTON | 変更     | button_update |        |        |            |
| BUTTON | 戻る     | button_back   |        |        |            |

**_アクション：変更_**

目標を更新する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 3.1.16. 全体進捗状況

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID     |
| PARAMS | 開始日     | filter_date_start | 日付   | 実行日の属する月の初日 | リストのフィルター条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 顧客名     | filter_company    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |

**_処理内容_**

ユーザーID、フィルター条件に該当する目標を取得し、顧客毎に契約報酬と目標工数を集計する。
顧客毎に、関与先および業務日報明細を取得し、消費報酬・消費工数・残報酬・残工数を集計する。
顧客毎の集計結果を全体進捗として集計する。
フィルター項目間は、AND条件とする。
リストは顧客名の仮名で昇順にソートする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名            | 型     | 特記 | 内容       |
| :----- | :----------- | :---------------- | :----- | :--- | :--------- |
| FORM   | 開始日       | filter_date_start | 日付   |      | 入力項目   |
| FORM   | 終了日       | filter_date_end   | 日付   |      | 入力項目   |
| FORM   | 作成者       | filter_creater    | 文字列 |      | 入力項目   |
| FORM   | 顧客名       | filter_company    | 文字列 |      | 入力項目   |
| BUTTON | 絞り込み     | button_filer      |        |      |            |
| BUTTON | リセット     | button_reset      |        |      |            |
| BUTTON | CSV出力      | button_export_csv |        |      |            |
| DISP   | 集計契約報酬 |                   | 数値   |      | 集計値     |
| DISP   | 集計目標工数 |                   | 数値   |      | 集計値     |
| DISP   | 集計消費報酬 |                   | 数値   |      | 集計値     |
| DISP   | 集計消費工数 |                   | 数値   |      | 集計値     |
| DISP   | 集計残報酬   |                   | 数値   |      | 集計値     |
| DISP   | 集計残工数   |                   | 数値   |      | 集計値     |
| LINK   | 顧客名       | company           | 文字列 |      | 目標の項目 |
| DISP   | 契約報酬     |                   | 数値   |      | 集計値     |
| DISP   | 目標工数     |                   | 数値   |      | 集計値     |
| DISP   | 消費報酬     |                   | 数値   |      | 集計値     |
| DISP   | 消費工数     |                   | 数値   |      | 集計値     |
| DISP   | 残報酬       |                   | 数値   |      | 集計値     |
| DISP   | 残工数       |                   | 数値   |      | 集計値     |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：CSV出力_**

全体進捗状況CSVファイルを出力する。

### 3.1.17. 個社別進捗状況

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |                        | 関与先のID                   |
| PARAMS | パス名     | request_pathname  | 文字列 |                        | 全体進捗状況の表示条件       |
| PARAMS | 開始日     | filter_date_start | 日付   | 実行日の属する月の初日 | 全体進捗状況の表示条件       |
| PARAMS | 終了日     | filter_date_end   | 日付   | 実行日                 | 全体進捗状況の表示条件       |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | 全体進捗状況の表示条件       |

> 顧客名のフィルター条件は、IDについての集計のため不要。

**_処理内容_**

ユーザーID、ID、フィルター条件に該当する目標を取得し、ユーザー毎およびユーザー全体での報酬・工数を集計する。
年月およびユーザー毎に、関与先および業務日報明細を取得し、報酬・工数を集計する。
全ての目標・実績を集計して、ユーザー毎およびユーザー全体での差分を集計し、時間単価も計算する。
フィルター項目間は、AND条件とする。
リストは年月で昇順にソートする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名                 | 物理名            | 型     | 特記   | 内容     |
| :----- | :--------------------- | :---------------- | :----- | :----- | :------- |
| FORM   | 開始日                 | filter_date_start | 日付   | 非活性 | 入力項目 |
| FORM   | 終了日                 | filter_date_end   | 日付   | 非活性 | 入力項目 |
| FORM   | 関与先                 | filter_company    | 選択肢 | 非活性 | 入力項目 |
| FORM   | 作成者                 | filter_creater    | 選択肢 |        | 入力項目 |
| BUTTON | 絞り込み               | button_filer      |        |        |          |
| BUTTON | リセット               | button_reset      |        |        |          |
| BUTTON | CSV出力                | button_export_csv |        |        |          |
| DISP   | 全体目標報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体目標工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体目標時間単価       |                   | 数値   |        | 集計値   |
| DISP   | 全体差分報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体差分工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体差分時間単価       |                   | 数値   |        | 集計値   |
| DISP   | 全体実績報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体実績工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体実績時間単価       |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標時間単価 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分時間単価 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績時間単価 |                   | 数値   |        | 集計値   |
| DISP   | 全体年月目標報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月目標工数       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月差分報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月差分工数       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月実績報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月実績工数       |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月目標報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月目標工数 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月差分報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月差分工数 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月実績報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月実績工数 |                   | 数値   |        | 集計値   |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：CSV出力_**

個社別進捗状況CSVファイルを出力する。

## 3.2. 帳票インターフェース

本サービスで出力すべき帳票は全て CSV ファイル経由で実施する。
CSV ファイルの詳細については、データ設計のファイルを参照。

<!-- pagebreak -->

# 4. データ設計

## 4.1. テーブル

テーブル定義書参照。

## 4.2. ファイル

### 4.2.1. 全体進捗状況CSVファイル

### 4.2.2. 個社別進捗状況CSVファイル
