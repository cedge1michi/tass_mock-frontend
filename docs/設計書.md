---
puppeteer:
  displayHeaderFooter: true
  headerTemplate: "<div style='font-size: 10px; margin-left: 1cm; width: 100%; text-align: center;'></div>"
  footerTemplate: "<div style='font-size: 10px; margin-left: 1cm; width: 100%; text-align: center;'><span class='pageNumber'></span> / <span class='totalPages'></span></div>"
---

<!-- ---
output: word_document
--- -->

<h1>目次</h1>

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1. システム構成](#1-システム構成)
- [2. 画面インターフェース設計](#2-画面インターフェース設計)
  - [2.1. 共通インターフェース](#21-共通インターフェース)
    - [2.1.1. ユーザー認証](#211-ユーザー認証)
    - [2.1.2. エラー表示](#212-エラー表示)
    - [2.1.3. ナビゲーション](#213-ナビゲーション)
  - [2.2. ホーム](#22-ホーム)
    - [2.2.1. ホーム](#221-ホーム)
  - [2.3. 業務日報](#23-業務日報)
    - [2.3.1. 業務日報一覧](#231-業務日報一覧)
    - [2.3.2. 業務日報作成](#232-業務日報作成)
    - [2.3.3. 業務日報編集](#233-業務日報編集)
    - [2.3.4. 業務日報明細作成](#234-業務日報明細作成)
    - [2.3.5. 業務日報明細編集](#235-業務日報明細編集)
    - [2.3.6. 業務日報明細一覧](#236-業務日報明細一覧)
  - [2.4. 業務処理簿](#24-業務処理簿)
    - [2.4.1. 業務処理簿一覧](#241-業務処理簿一覧)
    - [2.4.2. 業務処理簿作成](#242-業務処理簿作成)
    - [2.4.2. 業務処理簿編集](#242-業務処理簿編集)
  - [2.5. 進捗管理](#25-進捗管理)
    - [2.5.1. 目標一覧](#251-目標一覧)
    - [2.5.2. 目標作成](#252-目標作成)
    - [2.5.3. 目標編集](#253-目標編集)
    - [2.5.4. 全体進捗状況](#254-全体進捗状況)
    - [2.5.5. 個社別進捗状況](#255-個社別進捗状況)
  - [2.6. ビジネスマッチング](#26-ビジネスマッチング)
    - [2.6.1. 依頼一覧](#261-依頼一覧)
    - [2.6.2. 依頼作成](#262-依頼作成)
    - [2.6.3. 依頼編集](#263-依頼編集)
    - [2.6.4. 案件一覧](#264-案件一覧)
    - [2.6.5. 案件編集](#265-案件編集)
  - [2.7. マスター管理](#27-マスター管理)
    - [2.7.1. グループ](#271-グループ)
    - [2.7.2. ユーザー](#272-ユーザー)
    - [2.7.3. 関与先](#273-関与先)
  - [2.8. システム管理](#28-システム管理)
- [3. データ設計](#3-データ設計)
  - [3.1. テーブル](#31-テーブル)
  - [3.2. ファイル](#32-ファイル)
    - [3.2.1. 全体進捗明細CSVファイル](#321-全体進捗明細csvファイル)
    - [3.2.2. 個社別進捗明細CSVファイル](#322-個社別進捗明細csvファイル)
    - [3.2.3. 担当者別進捗明細CSVファイル](#323-担当者別進捗明細csvファイル)

<!-- /code_chunk_output -->

<!-- pagebreak -->

# 1. システム構成

<!-- pagebreak -->

# 2. 画面インターフェース設計

## 2.1. 共通インターフェース

### 2.1.1. ユーザー認証

**_ログイン_**

BASIC認証によりユーザー認証を行う。
ログインに成功したら、システム内にユーザーIDを保管する。

**_ログアウト_**

システム内に保管していたユーザーIDを削除し、ログアウトする。

### 2.1.2. エラー表示

**_入力エラーの場合_**

入力フィールド付近にエラー内容を表示する。

**_処理エラーの場合_**

ブラウザーの通知機能により実現する。

### 2.1.3. ナビゲーション

**_画面遷移図_**

サービス仕様書参照。以降同様。

## 2.2. ホーム

### 2.2.1. ホーム

**_画面イメージ_**

サービス仕様書参照。以降同様。

## 2.3. 業務日報

### 2.3.1. 業務日報一覧

**_入力項目_**

|  種別  | 論理名     | 物理名         | 型         | 内容           | 特記事項                       |
| :----: | :--------- | :------------- | :--------- | :------------- | :----------------------------- |
| SYSTEM | ユーザーID | uid            | 文字列     | ユーザーID     | ログインユーザー               |
| CONFIG | ページ件数 | page_size      | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日 | week_day_start | 整数文字列 | 週の開始曜日   | 0=日曜日                       |
| PARAMS | 開始日     | filter_start   | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=週の初日 |
| PARAMS | 終了日     | filter_end     | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=実行日   |
| PARAMS | 報告日報   | filter_summary | 文字列     | フィルター条件 | 部分一致                       |
| PARAMS | 作成者     | filter_creater | 整数文字列 | フィルター条件 |                                |
| PARAMS | ページ番号 | page_number    | 整数文字列 | ページ番号     | 未入力=1                       |

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務日報を取得する。

> 条件: ReportHeads:created_by == (取得したユーザーのid OR グループ内のユーザーid) AND フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは報告日、作成者の昇順とする。

**_出力項目_**

| 種別   | 論理名       | 物理名           | 型         | 内容                | 特記事項        |
| :----- | :----------- | :--------------- | :--------- | :------------------ | :-------------- |
| FORM   | 開始日       | filter_start     | 日付       | 入力項目            |
| FORM   | 終了日       | filter_end       | 日付       | 入力項目            |
| FORM   | 報告日報     | filter_summary   | 文字列     | 入力項目            |
| FORM   | 作成者       | filter_creater   | 選択肢     | 入力項目            |
| BUTTON | 絞り込み     | button_filer     |
| BUTTON | リセット     | button_reset     |
| BUTTON | 編集         | button_edit      |
| DISP   | 報告日       | report_on        | 日付文字列 | レコードの項目      | 書式=YYYY/MM/DD |
| DISP   | 報告日報     | summary          | 文字列     | レコードの項目      |
| DISP   | 作成者       | creater          | 文字列     | レコードの項目      |
| DISP   | 開始番号     | page_rec_start   | 整数文字列 | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end     | 整数文字列 | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number | 整数文字列 | レコード件数        |
| LINK   | ページ番号   | page_number      | 整数文字列 | 前後2ページ分を表示 |
| BUTTON | 新規作成     | button_new       |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：編集_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

**_アクション：新規作成_**

遷移先の画面を表示する。

### 2.3.2. 業務日報作成

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型     | 内容       | 特記事項         |
| :----: | :--------- | :----- | :----- | :--------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列 | ユーザーID | ログインユーザー |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_start
> - filter_end
> - filter_summary
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start <= 実行日 <= Users:end)

**_出力項目_**

| 種別   | 論理名     | 物理名        | 型               | 内容                 | 特記事項      |
| :----- | :--------- | :------------ | :--------------- | :------------------- | :------------ |
| FORM   | 対象日     | date          | 日付             | レコード作成日       | 初期値=実行日 |
| FORM   | インポート | import        | チェックボックス | 予定インポートの有無 | 初期値=True   |
| BUTTON | 作成       | button_create |
| BUTTON | 戻る       | button_back   |

**_アクション：作成_**

業務日報を作成する。
オフィスアカウントありの場合、カレンダーの対象日の予定を元に、業務日報明細を作成する。

> 条件: import == true AND Employees:office_account == 10

> 業務日報明細と予定の項目の対応は以下の通り。
>
> - ReportBodies:start_at = 開始日時
> - ReportBodies:end_at = 終了日時
> - ReportBodies:title = タイトル

正常終了後は、フィルター条件をリセットする。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.3.3. 業務日報編集

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_start
> - filter_end
> - filter_summary
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務日報を取得する。

> 条件: ReportHeads:id == rid AND ReportHeads:created_by == (取得したユーザーのid OR グループ内のユーザーid)

業務日報明細を取得する。

> 条件: 取得した業務日報を参照している全レコード。
> レコードの並びは開始日時、業務名の昇順とする。

**_出力項目_**

| 種別   | 論理名          | 物理名              | 型         | 内容                       | 特記事項              |
| :----- | :-------------- | :------------------ | :--------- | :------------------------- | :-------------------- |
| FORM   | 報告日          | report_head_date    | 日付       | 業務日報レコードの項目     | 非活性                |
| FORM   | 作成者          | report_head_creater | 選択肢     | 業務日報レコードの項目     | 非活性                |
| FORM   | 業務日報        | report_head_summary | テキスト   | 業務日報レコードの項目     |
| BUTTON | 保存            | button_update       |
| BUTTON | 削除            | button_delete       |
| BUTTON | 戻る            | button_back         |
| BUTTON | 編集            | button_edit         |
| DISP   | 開始日時        | report_body_start   | 日時文字列 | 業務日報明細レコードの項目 | 書式=YYYY/mm/dd HH:MM |
| DISP   | 終了日時        | report_body_end     | 日時文字列 | 業務日報明細レコードの項目 | 書式=YYYY/mm/dd HH:MM |
| DISP   | 業務名          | report_body_title   | 文字列     | 業務日報明細レコードの項目 |
| DISP   | 関与先/業務内容 | report_body_client  | 文字列     | 業務日報明細レコードの項目 |
| BUTTON | 新規作成        | button_new          |

**_アクション：保存_**

業務日報を更新する。

**_アクション：削除_**

業務日報と業務日報明細を削除する。

**_アクション：戻る_**

遷移先の画面を表示する。

**_アクション：業務名_**

遷移先の画面を表示する。

**_アクション：明細追加_**

遷移先の画面を表示する。

### 2.3.4. 業務日報明細作成

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_start
> - filter_end
> - filter_summary
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start <= 実行日 <= Users:end)

業務日報を取得する。

> 条件: ReportHeads:id == rid AND ReportHeads:created_by == 取得したユーザーのid

**_出力項目_**

| 種別   | 論理名           | 物理名                      | 型               | 内容                   | 特記事項   |
| :----- | :--------------- | :-------------------------- | :--------------- | :--------------------- | :--------- |
| FORM   | 報告日           | report_head_date            | 日付             | 業務日報レコードの項目 | 非活性     |
| FORM   | 作成者           | report_head_creater         | 選択肢           | 業務日報レコードの項目 | 非活性     |
| FORM   | 業務日報         | report_head_summary         | テキスト         | 業務日報レコードの項目 | 非活性     |
| FORM   | 開始日時         | report_body_start           | 日時             | report_head_date       | 時刻=09:00 |
| FORM   | 終了日時         | report_body_end             | 日時             | report_head_date       | 時刻=09:00 |
| FORM   | 業務名           | report_body_title           | 文字列           |
| FORM   | 業務内容         | report_body_description     | テキスト         |
| FORM   | 業務区分         | report_body_types           | チェックボックス |
| FORM   | 関与先/業務内容  | report_body_client          | 選択肢           |
| FORM   | 内容             | report_body_outline         | 選択肢           |
| FORM   | 内容（その他）   | report_body_outline_other   | 文字列           |
| FORM   | てん末           | report_body_detail          | 選択肢           |
| FORM   | てん末（その他） | report_body_detail_other    | 文字列           |
| FORM   | 対象年月         | report_body_date            | 年月             |
| FORM   | 処理年月日       | report_body_process_date    | 日付             |
| FORM   | 添付ファイル     | report_body_attachment_name | ファイル         |
| FORM   | 提出年月日       | report_body_submit_date     | 日付             |
| FORM   | 担当税理士       | report_body_taxaccountant   | 選択肢           |
| FORM   | 備考             | report_body_note            | テキスト         |
| BUTTON | 作成             | button_create               |
| BUTTON | 戻る             | button_back                 |

**_アクション：作成_**

業務日報明細を作成する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.3.5. 業務日報明細編集

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> 業務日報一覧から遷移している場合
>
> - pathname
> - filter_start
> - filter_end
> - filter_summary
> - filter_creater
> - page_number
>
> 業務日報一覧から遷移している場合
>
> - pathname
> - filter_start
> - filter_end
> - filter_title
> - filter_client
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務日報明細を取得する。

> 条件: ReportBodies:id == rid AND ReportBodies:created_by == (取得したユーザーのid OR グループ内のユーザーid)

業務日報を取得する。

> 条件: 取得した業務日報明細が参照している業務日報

**_出力項目_**

| 種別   | 論理名           | 物理名                      | 型               | 内容               | 特記事項 |
| :----- | :--------------- | :-------------------------- | :--------------- | :----------------- | :------- |
| FORM   | 報告日           | report_head_date            | 日付             | 業務日報の項目     | 非活性   |
| FORM   | 作成者           | report_head_creater         | 選択肢           | 業務日報の項目     | 非活性   |
| FORM   | 業務日報         | report_head_summary         | テキスト         | 業務日報の項目     | 非活性   |
| FORM   | 開始日時         | report_body_start           | 日時             | 業務日報明細の項目 |
| FORM   | 終了日時         | report_body_end             | 日時             | 業務日報明細の項目 |
| FORM   | 業務名           | report_body_title           | 文字列           | 業務日報明細の項目 |
| FORM   | 業務内容         | report_body_description     | テキスト         | 業務日報明細の項目 |
| FORM   | 業務区分         | report_body_types           | チェックボックス | 業務日報明細の項目 |
| FORM   | 関与先/業務内容  | report_body_client          | 選択肢           | 業務日報明細の項目 |
| FORM   | 内容             | report_body_outline         | 選択肢           | 業務日報明細の項目 |
| FORM   | 内容（その他）   | report_body_outline_other   | 文字列           | 業務日報明細の項目 |
| FORM   | てん末           | report_body_detail          | 選択肢           | 業務日報明細の項目 |
| FORM   | てん末（その他） | report_body_detail_other    | 文字列           | 業務日報明細の項目 |
| FORM   | 対象年月         | report_body_date            | 年月             | 業務日報明細の項目 |
| FORM   | 処理年月日       | report_body_process_date    | 日付             | 業務日報明細の項目 |
| FORM   | 添付ファイル     | report_body_attachment_name | ファイル         | 業務日報明細の項目 |
| FORM   | 提出年月日       | report_body_submit_date     | 日付             | 業務日報明細の項目 |
| FORM   | 担当税理士       | report_body_taxaccountant   | 選択肢           | 業務日報明細の項目 |
| FORM   | 備考             | report_body_note            | テキスト         | 業務日報明細の項目 |
| BUTTON | 保存             | button_update               |
| BUTTON | 削除             | button_delete               |
| BUTTON | 戻る             | button_back                 |

**_アクション：保存_**

業務日報明細を更新する。

**_アクション：削除_**

業務日報明細を削除する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.3.6. 業務日報明細一覧

**_入力項目_**

|  種別  | 論理名          | 物理名         | 型         | 内容           | 特記事項                       |
| :----: | :-------------- | :------------- | :--------- | :------------- | :----------------------------- |
| SYSTEM | ユーザーID      | uid            | 文字列     | ユーザーID     | ログインユーザー               |
| CONFIG | ページ件数      | page_size      | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日      | week_day_start | 整数文字列 | 週の開始曜日   | 0=日曜日                       |
| PARAMS | 開始日          | filter_start   | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=週の初日 |
| PARAMS | 終了日          | filter_end     | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=実行日   |
| PARAMS | 業務名          | filter_title   | 文字列     | フィルター条件 | 部分一致                       |
| PARAMS | 関与先/業務内容 | filter_client  | 整数文字列 | フィルター条件 |                                |
| PARAMS | 作成者          | filter_creater | 整数文字列 | フィルター条件 |                                |
| PARAMS | ページ番号      | page_number    | 整数文字列 | ページ番号     | 未入力=1                       |

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務日報明細を取得する。

> 条件: ReportBodies:created_by == (取得したユーザーのid OR グループ内のユーザーid) AND フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは開始日時、業務名の昇順とする。

**_出力項目_**

| 種別   | 論理名          | 物理名           | 型         | 内容                | 特記事項              |
| :----- | :-------------- | :--------------- | :--------- | :------------------ | :-------------------- |
| FORM   | 開始日          | filter_start     | 日付       | 入力項目            |
| FORM   | 終了日          | filter_end       | 日付       | 入力項目            |
| FORM   | 業務名          | filter_title     | 文字列     | 入力項目            |
| FORM   | 関与先/業務内容 | filter_client    | 選択肢     | 入力項目            |
| FORM   | 作成者          | filter_creater   | 選択肢     | 入力項目            |
| BUTTON | 絞り込み        | button_filer     |
| BUTTON | リセット        | button_reset     |
| BUTTON | 編集            | button_edit      |
| DISP   | 開始日時        | start_at         | 日時文字列 | レコードの項目      | 書式=YYYY/mm/dd MM:DD |
| DISP   | 終了日時        | end_at           | 日時文字列 | レコードの項目      | 書式=YYYY/mm/dd MM:DD |
| DISP   | 業務名          | title            | 文字列     | レコードの項目      |
| DISP   | 関与先/業務内容 | client           | 文字列     | レコードの項目      |
| DISP   | 作成者          | creater          | 文字列     | レコードの項目      |
| DISP   | 開始番号        | page_rec_start   | 整数文字列 | レコードの開始番号  |
| DISP   | 終了番号        | page_rec_end     | 整数文字列 | レコードの終了番号  |
| DISP   | レコード件数    | total_rec_number | 整数文字列 | レコード件数        |
| LINK   | ページ番号      | page_number      | 整数文字列 | 前後2ページ分を表示 |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：編集_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

## 2.4. 業務処理簿

### 2.4.1. 業務処理簿一覧

**_入力項目_**

|  種別  | 論理名     | 物理名         | 型         | 内容           | 特記事項                       |
| :----: | :--------- | :------------- | :--------- | :------------- | :----------------------------- |
| SYSTEM | ユーザーID | uid            | 文字列     | ユーザーID     | ログインユーザー               |
| CONFIG | ページ件数 | page_size      | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日 | week_day_start | 整数文字列 | 週の開始曜日   | 0=日曜日                       |
| PARAMS | 開始日     | filter_start   | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=週の初日 |
| PARAMS | 終了日     | filter_end     | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=実行日   |
| PARAMS | 委嘱者     | filter_client  | 整数文字列 | フィルター条件 |                                |
| PARAMS | 内容       | filter_outline | 整数文字列 | フィルター条件 |                                |
| PARAMS | てん末     | filter_detail  | 整数文字列 | フィルター条件 |                                |
| PARAMS | 作成者     | filter_creater | 整数文字列 | フィルター条件 |                                |
| PARAMS | ページ番号 | page_number    | 整数文字列 | ページ番号     | 未入力=1                       |

> 委嘱者：関与先の名称のみ。idは該当する関与先idの最小値とする。以下同様。

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務処理簿を取得する。

> 条件: BusinessActivities:created_by == (取得したユーザーのid OR グループ内のユーザーid) AND フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは処理年月日、委嘱者の昇順とする。

**_出力項目_**

| 種別   | 論理名       | 物理名           | 型               | 内容                | 特記事項        |
| :----- | :----------- | :--------------- | :--------------- | :------------------ | :-------------- |
| FORM   | 開始日       | filter_start     | 日付             | 入力項目            |
| FORM   | 終了日       | filter_end       | 日付             | 入力項目            |
| FORM   | 委嘱者       | filter_client    | 選択肢           | 入力項目            |
| FORM   | 内容         | filter_outline   | 選択肢           | 入力項目            |
| FORM   | てん末       | filter_detail    | 選択肢           | 入力項目            |
| FORM   | 作成者       | filter_creater   | 選択肢           | 入力項目            |
| BUTTON | 絞り込み     | button_filer     |
| BUTTON | リセット     | button_reset     |
| BUTTON | 編集         | button_edit      |
| DISP   | 業務区分     | types            | 複数選択肢文字列 | レコードの項目      |
| DISP   | 委嘱者       | client           | 文字列           | レコードの項目      |
| DISP   | 内容         | outline          | 文字列           | レコードの項目      |
| DISP   | てん末       | detail           | 文字列           | レコードの項目      |
| DISP   | 処理年月日   | process_on       | 日付文字列       | レコードの項目      | 書式=YYYY/mm/dd |
| DISP   | 作成者       | creater          | 文字列           | レコードの項目      |
| DISP   | 担当税理士   | tax_accountant   | 文字列           | レコードの項目      |
| DISP   | 開始番号     | page_rec_start   | 整数文字列       | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end     | 整数文字列       | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number | 整数文字列       | レコード件数        |
| LINK   | ページ番号   | page_number      | 整数文字列       | 前後2ページ分を表示 |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：編集_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

### 2.4.2. 業務処理簿作成

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型     | 内容       | 特記事項         |
| :----: | :--------- | :----- | :----- | :--------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列 | ユーザーID | ログインユーザー |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_start
> - filter_end
> - filter_client
> - filter_outline
> - filter_detail
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

**_出力項目_**

| 種別   | 論理名           | 物理名         | 型               | 内容           | 特記事項 |
| :----- | :--------------- | :------------- | :--------------- | :------------- | :------- |
| FORM   | 業務区分         | types          | チェックボックス | レコードの項目 |          |
| FORM   | 委嘱者           | client         | 選択肢           | レコードの項目 |          |
| FORM   | 内容             | outline        | 選択肢           | レコードの項目 |          |
| FORM   | 内容（その他）   | outline_other  | 文字列           | レコードの項目 |          |
| FORM   | てん末           | detail         | 選択肢           | レコードの項目 |          |
| FORM   | てん末（その他） | detail_other   | 文字列           | レコードの項目 |          |
| FORM   | 対象年月         | report_on      | 年月             | レコードの項目 |          |
| FORM   | 処理年月日       | process_on     | 日付             | レコードの項目 |          |
| FORM   | 添付ファイル     | attachment     | ファイル         | レコードの項目 |          |
| FORM   | 提出年月日       | submit_on      | 日付             | レコードの項目 |          |
| FORM   | 担当税理士       | tax_accountant | 選択肢           | レコードの項目 |          |
| FORM   | 備考             | note           | テキスト         | レコードの項目 |          |
| BUTTON | 作成             | button_create  |
| BUTTON | 戻る             | button_back    |

**_アクション：作成_**

業務処理簿を作成する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.4.2. 業務処理簿編集

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_start
> - filter_end
> - filter_client
> - filter_outline
> - filter_detail
> - filter_creater
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

業務処理簿を取得する。

> 条件: BusinessActivities:id == rid AND BusinessActivities:created_by == (取得したユーザーのid OR グループ内のユーザーid)

**_出力項目_**

| 種別   | 論理名           | 物理名         | 型               | 内容           | 特記事項 |
| :----- | :--------------- | :------------- | :--------------- | :------------- | :------- |
| FORM   | 業務区分         | types          | チェックボックス | レコードの項目 |          |
| FORM   | 委嘱者           | client         | 選択肢           | レコードの項目 |          |
| FORM   | 作成者           | creater        | 選択肢           | レコードの項目 | 非活性   |
| FORM   | 内容             | outline        | 選択肢           | レコードの項目 |          |
| FORM   | 内容（その他）   | outline_other  | 文字列           | レコードの項目 |          |
| FORM   | てん末           | detail         | 選択肢           | レコードの項目 |          |
| FORM   | てん末（その他） | detail_other   | 文字列           | レコードの項目 |          |
| FORM   | 対象年月         | report_on      | 年月             | レコードの項目 |          |
| FORM   | 処理年月日       | process_on     | 日付             | レコードの項目 |          |
| FORM   | 添付ファイル     | attachment     | ファイル         | レコードの項目 |          |
| FORM   | 提出年月日       | submit_on      | 日付             | レコードの項目 |          |
| FORM   | 担当税理士       | tax_accountant | 選択肢           | レコードの項目 |          |
| FORM   | 備考             | note           | テキスト         | レコードの項目 |          |
| BUTTON | 保存             | button_update  |
| BUTTON | 削除             | button_delete  |
| BUTTON | 戻る             | button_back    |

**_アクション：保存_**

業務処理簿を更新する。

**_アクション：削除_**

業務処理簿を削除する。

**_アクション：戻る_**

遷移先の画面を表示する。

## 2.5. 進捗管理

### 2.5.1. 目標一覧

**_入力項目_**

|  種別  | 論理名     | 物理名         | 型         | 内容           | 特記事項                           |
| :----: | :--------- | :------------- | :--------- | :------------- | :--------------------------------- |
| SYSTEM | ユーザーID | uid            | 文字列     | ユーザーID     | ログインユーザー                   |
| CONFIG | ページ件数 | page_size      | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日 | week_day_start | 整数文字列 | 週の開始曜日   | 0=日曜日                           |
| PARAMS | 開始年月   | filter_start   | 日付文字列 | フィルター条件 | 書式=YYYYMM、未入力=会計年度の初月 |
| PARAMS | 終了年月   | filter_end     | 日付文字列 | フィルター条件 | 書式=YYYYMM、未入力=会計年度の末月 |
| PARAMS | 関与先     | filter_client  | 整数文字列 | フィルター条件 |
| PARAMS | ページ番号 | page_number    | 数値       | ページ番号     | 未入力=1                           |

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

目標を取得する。

> 条件: UserGoals:created_by == (取得したユーザーのid OR グループ内のユーザーid) AND フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは開始年月、関与先/業務内容の昇順とする。

- 関与先/業務内容別に、下記を算出する。
  - 報酬
    Client:pay
  - 計画時間
    UserGoal:hours
  - コスト
    User:unit_price \* UserGoal:hours
  - 利益
    報酬 - コスト

**_出力項目_**

| 種別   | 論理名          | 物理名           | 型     | 内容                | 特記事項      |
| :----- | :-------------- | :--------------- | :----- | :------------------ | :------------ |
| FORM   | 開始年月        | filter_start     | 日付   | 入力項目            |
| FORM   | 終了年月        | filter_end       | 日付   | 入力項目            |
| FORM   | 関与先          | filter_client    | 選択肢 | 入力項目            |
| BUTTON | 絞り込み        | button_filer     |
| BUTTON | リセット        | button_reset     |
| BUTTON | 編集            | button_edit      |
| DISP   | 開始年月        | start            | 文字列 | レコードの項目      | 書式：YYYY/mm |
| DISP   | 終了年月        | end              | 文字列 | レコードの項目      | 書式：YYYY/mm |
| DISP   | 関与先/業務内容 | client           | 文字列 | レコードの項目      |
| DISP   | 報酬            | pay              | 整数   | 計算結果            |
| DISP   | 計画時間        | hours            | 整数   | 計算結果            |
| DISP   | コスト          | cost             | 整数   | 計算結果            |
| DISP   | 利益            | profit           | 整数   | 計算結果            |
| DISP   | 開始番号        | page_rec_start   | 整数   | レコードの開始番号  |
| DISP   | 終了番号        | page_rec_end     | 整数   | レコードの終了番号  |
| DISP   | レコード件数    | total_rec_number | 整数   | レコード件数        |
| LINK   | ページ番号      | page_number      | 整数   | 前後2ページ分を表示 |
| BUTTON | 新規作成        | button_new       |        |                     |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：編集_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

**_アクション：新規作成_**

遷移先の画面を表示する。

### 2.5.2. 目標作成

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 開始日     | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 関与先     | filter_client     | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

ユーザーIDにて、処理日で所属している該当するユーザーを取得する。

**_出力項目_**

| 種別   | 論理名   | 物理名        | 型     | 特記   | 内容 |
| :----- | :------- | :------------ | :----- | :----- | :--- |
| FORM   | 開始日   | date_start    | 日付   | 必須   |      |
| FORM   | 終了日   | date_end      | 日付   | 必須   |      |
| FORM   | 作成者   | creater       | 選択肢 | 非活性 |      |
| FORM   | 関与先   | client        | 選択肢 | 必須   |      |
| FORM   | 時間単価 | unit_price    | 数値   | 必須   |      |
| FORM   | 工数     | man_hour      | 数値   | 必須   |      |
| BUTTON | 作成     | button_create |        |        |      |
| BUTTON | 戻る     | button_back   |        |        |      |

**_アクション：作成_**

目標を作成する。
処理後は、遷移先の画面を表示する。

> 以下の場合、遷移先の画面に、作成したデータは含まれない。
>
> - 表示していたフィルター条件、ページ番号に該当しない場合。

> 回避方法：レコード作成の場合は、フィルター、ソート条件をリセットすることで対応する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.5.3. 目標編集

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :----- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |        | レコードのID                 |
| PARAMS | パス名     | request_pathname  | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 開始日     | filter_date_start | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   |        | 一覧画面の表示条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | 関与先     | filter_client     | 文字列 |        | 一覧画面の表示条件           |
| PARAMS | ページ番号 | page_number       | 数値   |        | 一覧画面の表示条件           |

**_処理内容_**

IDに該当する目標を取得する。

**_出力項目_**

| 種別   | 論理名   | 物理名        | 型     | 特記   | 内容           |
| :----- | :------- | :------------ | :----- | :----- | :------------- |
| FORM   | 開始日   | date_start    | 日付   | 必須   | レコードの項目 |
| FORM   | 終了日   | date_end      | 日付   | 必須   | レコードの項目 |
| FORM   | 作成者   | creater       | 選択肢 | 非活性 | レコードの項目 |
| FORM   | 関与先   | client        | 選択肢 | 必須   | レコードの項目 |
| FORM   | 時間単価 | unit_price    | 数値   | 必須   | レコードの項目 |
| FORM   | 工数     | man_hour      | 数値   | 必須   | レコードの項目 |
| BUTTON | 変更     | button_update |        |        |                |
| BUTTON | 戻る     | button_back   |        |        |                |

**_アクション：変更_**

目標を更新する。
処理後は、遷移先の画面を表示する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.5.4. 全体進捗状況

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                             |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :------------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID     |
| PARAMS | 開始日     | filter_date_start | 日付   | 実行日の属する月の初日 | リストのフィルター条件           |
| PARAMS | 終了日     | filter_date_end   | 日付   | 実行日                 | リストのフィルター条件           |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | リストのフィルター条件(部分一致) |
| PARAMS | 顧客名     | filter_client     | 文字列 | ブランク               | リストのフィルター条件(部分一致) |

**_処理内容_**

ユーザーID、フィルター条件に該当する目標を取得し、顧客毎に契約報酬と目標工数を集計する。
顧客毎に、関与先および業務日報明細を取得し、消費報酬・消費工数・残報酬・残工数を集計する。
顧客毎の集計結果を全体進捗として集計する。
フィルター項目間は、AND条件とする。
リストは顧客名の仮名で昇順にソートする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名       | 物理名            | 型     | 特記 | 内容       |
| :----- | :----------- | :---------------- | :----- | :--- | :--------- |
| FORM   | 開始日       | filter_date_start | 日付   |      | 入力項目   |
| FORM   | 終了日       | filter_date_end   | 日付   |      | 入力項目   |
| FORM   | 作成者       | filter_creater    | 文字列 |      | 入力項目   |
| FORM   | 顧客名       | filter_client     | 文字列 |      | 入力項目   |
| BUTTON | 絞り込み     | button_filer      |        |      |            |
| BUTTON | リセット     | button_reset      |        |      |            |
| BUTTON | CSV出力      | button_export_csv |        |      |            |
| DISP   | 集計契約報酬 |                   | 数値   |      | 集計値     |
| DISP   | 集計目標工数 |                   | 数値   |      | 集計値     |
| DISP   | 集計消費報酬 |                   | 数値   |      | 集計値     |
| DISP   | 集計消費工数 |                   | 数値   |      | 集計値     |
| DISP   | 集計残報酬   |                   | 数値   |      | 集計値     |
| DISP   | 集計残工数   |                   | 数値   |      | 集計値     |
| LINK   | 顧客名       | client            | 文字列 |      | 目標の項目 |
| DISP   | 契約報酬     |                   | 数値   |      | 集計値     |
| DISP   | 目標工数     |                   | 数値   |      | 集計値     |
| DISP   | 消費報酬     |                   | 数値   |      | 集計値     |
| DISP   | 消費工数     |                   | 数値   |      | 集計値     |
| DISP   | 残報酬       |                   | 数値   |      | 集計値     |
| DISP   | 残工数       |                   | 数値   |      | 集計値     |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：CSV出力_**

全体進捗状況CSVファイルを出力する。

### 2.5.5. 個社別進捗状況

**_入力項目_**

|  種別  | 論理名     | 物理名            | 型     | 初期値                 | 内容                         |
| :----: | :--------- | :---------------- | :----- | :--------------------- | :--------------------------- |
| SYSTEM | ユーザーID | user_id           | 数値   |                        | ログインユーザーのユーザーID |
| PARAMS | ID         | id                | 数値   |                        | 関与先のID                   |
| PARAMS | パス名     | request_pathname  | 文字列 |                        | 全体進捗状況の表示条件       |
| PARAMS | 開始日     | filter_date_start | 日付   | 実行日の属する月の初日 | 全体進捗状況の表示条件       |
| PARAMS | 終了日     | filter_date_end   | 日付   | 実行日                 | 全体進捗状況の表示条件       |
| PARAMS | 作成者     | filter_creater    | 文字列 | ブランク               | 全体進捗状況の表示条件       |

> 顧客名のフィルター条件は、IDについての集計のため不要。

**_処理内容_**

ユーザーID、ID、フィルター条件に該当する目標を取得し、ユーザー毎およびユーザー全体での報酬・工数を集計する。
年月およびユーザー毎に、関与先および業務日報明細を取得し、報酬・工数を集計する。
全ての目標・実績を集計して、ユーザー毎およびユーザー全体での差分を集計し、時間単価も計算する。
フィルター項目間は、AND条件とする。
リストは年月で昇順にソートする。
ユーザーが事務所管理者の場合は、事務所の全スタッフ分を表示する。
ユーザーがグループ管理者の場合は、グループの全スタッフ分を表示する。

**_出力項目_**

| 種別   | 論理名                 | 物理名            | 型     | 特記   | 内容     |
| :----- | :--------------------- | :---------------- | :----- | :----- | :------- |
| FORM   | 開始日                 | filter_date_start | 日付   | 非活性 | 入力項目 |
| FORM   | 終了日                 | filter_date_end   | 日付   | 非活性 | 入力項目 |
| FORM   | 関与先                 | filter_client     | 選択肢 | 非活性 | 入力項目 |
| FORM   | 作成者                 | filter_creater    | 選択肢 |        | 入力項目 |
| BUTTON | 絞り込み               | button_filer      |        |        |          |
| BUTTON | リセット               | button_reset      |        |        |          |
| BUTTON | CSV出力                | button_export_csv |        |        |          |
| DISP   | 全体目標報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体目標工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体目標時間単価       |                   | 数値   |        | 集計値   |
| DISP   | 全体差分報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体差分工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体差分時間単価       |                   | 数値   |        | 集計値   |
| DISP   | 全体実績報酬           |                   | 数値   |        | 集計値   |
| DISP   | 全体実績工数           |                   | 数値   |        | 集計値   |
| DISP   | 全体実績時間単価       |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別目標時間単価 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別差分時間単価 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績報酬     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績工数     |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別実績時間単価 |                   | 数値   |        | 集計値   |
| DISP   | 全体年月目標報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月目標工数       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月差分報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月差分工数       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月実績報酬       |                   | 数値   |        | 集計値   |
| DISP   | 全体年月実績工数       |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月目標報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月目標工数 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月差分報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月差分工数 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月実績報酬 |                   | 数値   |        | 集計値   |
| DISP   | ユーザー別年月実績工数 |                   | 数値   |        | 集計値   |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：CSV出力_**

個社別進捗状況CSVファイルを出力する。

## 2.6. ビジネスマッチング

### 2.6.1. 依頼一覧

**_入力項目_**

|  種別  | 論理名     | 物理名          | 型         | 内容           | 特記事項                     |
| :----: | :--------- | :-------------- | :--------- | :------------- | :--------------------------- |
| SYSTEM | ユーザーID | uid             | 文字列     | ユーザーID     | ログインユーザー             |
| CONFIG | ページ件数 | page_size       | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日 | week_day_start  | 整数文字列 | 週の開始曜日   | 0=日曜日                     |
| PARAMS | 種別       | filter_type     | 整数文字列 | フィルター条件 |
| PARAMS | カテゴリー | filter_category | 整数文字列 | フィルター条件 |
| PARAMS | タイトル   | filter_title    | 文字列     | フィルター条件 | 部分一致                     |
| PARAMS | 開始日     | filter_start    | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=実行日 |
| PARAMS | 終了日     | filter_end      | 日付文字列 | フィルター条件 |
| PARAMS | ページ番号 | page_number     | 整数文字列 | ページ番号     | 未入力=1                     |

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

ビジネスマッチ登録を取得する。

> 条件: フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは期限、カテゴリーの昇順とする。

**_出力項目_**

| 種別   | 論理名       | 物理名           | 型           | 内容                | 特記事項                           |
| :----- | :----------- | :--------------- | :----------- | :------------------ | :--------------------------------- |
| FORM   | 種別         | filter_type      | 選択肢       | 入力項目            |
| FORM   | カテゴリー   | filter_category  | 選択肢       | 入力項目            |
| FORM   | タイトル     | filter_title     | 文字列       | 入力項目            |
| FORM   | 開始日       | filter_start     | 日付         | 入力項目            |
| FORM   | 終了日       | filter_end       | 日付         | 入力項目            |
| BUTTON | 絞り込み     | button_filer     |
| BUTTON | リセット     | button_reset     |
| DISP   | 種別         | type             | 文字列       | レコードの項目      |
| DISP   | カテゴリー   | category         | 文字列       | レコードの項目      |
| LINK   | タイトル     | title            | 文字列       | レコードの項目      | 作成日から7日以内の場合、Newを表示 |
| DISP   | 予算         | budget           | カンマ文字列 | レコードの項目      |
| DISP   | 期限         | expired_on       | 日付文字列   | レコードの項目      | 書式=YYYY/mm/dd                    |
| DISP   | 開始番号     | page_rec_start   | 整数文字列   | レコードの開始番号  |
| DISP   | 終了番号     | page_rec_end     | 整数文字列   | レコードの終了番号  |
| DISP   | レコード件数 | total_rec_number | 整数文字列   | レコード件数        |
| LINK   | ページ番号   | page_number      | 整数文字列   | 前後2ページ分を表示 |
| BUTTON | 新規作成     | button_new       |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：タイトル_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

**_アクション：新規作成_**

遷移先の画面を表示する。

### 2.6.2. 依頼作成

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型     | 内容       | 特記事項         |
| :----: | :--------- | :----- | :----- | :--------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列 | ユーザーID | ログインユーザー |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_type
> - filter_category
> - filter_title
> - filter_start
> - filter_end
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

**_出力項目_**

| 種別   | 論理名       | 物理名        | 型       | 内容 | 特記事項      |
| :----- | :----------- | :------------ | :------- | :--- | :------------ |
| FORM   | 種別         | type          | 選択肢   |
| FORM   | カテゴリー   | category      | 選択肢   |
| FORM   | タイトル     | title         | 文字列   |
| FORM   | 予算         | budget        | 整数     |
| FORM   | 期限         | expired_on    | 日付     |      | 初期値=実行日 |
| FORM   | 添付ファイル | attachment    | ファイル |
| FORM   | 内容         | description   | テキスト |
| BUTTON | 作成         | button_create |
| BUTTON | 戻る         | button_back   |

**_アクション：作成_**

ビジネスマッチ登録を作成する。
正常終了後は、フィルター条件をリセットする。
得意分野に該当するユーザーへメールを送信する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.6.3. 依頼編集

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_type
> - filter_category
> - filter_title
> - filter_start
> - filter_end
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

ビジネスマッチ登録を取得する。

> 条件: BusinessMatchEntries:id == rid

**_出力項目_**

| 種別   | 論理名       | 物理名        | 型       | 内容           | 特記事項           |
| :----- | :----------- | :------------ | :------- | :------------- | :----------------- |
| FORM   | 種別         | type          | 選択肢   | レコードの項目 |
| FORM   | カテゴリー   | category      | 選択肢   | レコードの項目 |
| FORM   | タイトル     | title         | 文字列   | レコードの項目 |
| FORM   | 予算         | budget        | 整数     | レコードの項目 |
| FORM   | 期限         | expired_on    | 日付     | レコードの項目 | 初期値=実行日      |
| FORM   | 添付ファイル | attachment    | ファイル | レコードの項目 |
| FORM   | 内容         | description   | テキスト | レコードの項目 |
| FORM   | 応募金額     | pay           | 整数     | budget         | 依頼者は非表示     |
| FORM   | 応募コメント | comment       | テキスト |                | 依頼者は非表示     |
| BUTTON | 変更         | button_update |          |                | 依頼者以外は非表示 |
| BUTTON | 削除         | button_delete |          |                | 依頼者以外は非表示 |
| BUTTON | 応募         | button_apply  |          |                | 依頼者は非表示     |
| BUTTON | 戻る         | button_back   |

**_アクション：変更_**

ビジネスマッチ登録を更新する。
ただし、案件が存在する場合は、エラーを表示する。

**_アクション：削除_**

ビジネスマッチ登録を削除する。
ただし、案件が存在する場合は、エラーを表示する。

**_アクション：応募_**

案件を作成する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 応募

commentが入力されている場合、コメントを作成する。

**_アクション：戻る_**

遷移先の画面を表示する。

### 2.6.4. 案件一覧

**_入力項目_**

|  種別  | 論理名     | 物理名          | 型         | 内容           | 特記事項                       |
| :----: | :--------- | :-------------- | :--------- | :------------- | :----------------------------- |
| SYSTEM | ユーザーID | uid             | 文字列     | ユーザーID     | ログインユーザー               |
| CONFIG | ページ件数 | page_size       | 整数文字列 | ページ件数     |
| CONFIG | 週開始曜日 | week_day_start  | 整数文字列 | 週の開始曜日   | 0=日曜日                       |
| PARAMS | 種別       | filter_type     | 整数文字列 | フィルター条件 |
| PARAMS | カテゴリー | filter_category | 整数文字列 | フィルター条件 |
| PARAMS | タイトル   | filter_title    | 文字列     | フィルター条件 | 部分一致                       |
| PARAMS | 開始日     | filter_start    | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=週の初日 |
| PARAMS | 終了日     | filter_end      | 日付文字列 | フィルター条件 | 書式=YYYYMMDD、未入力=実行日   |
| PARAMS | ページ番号 | page_number     | 整数文字列 | ページ番号     | 未入力=1                       |

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

案件を取得する。

> 条件: (BusinessMatchEntries:created_by OR Deals:created_by) == 取得したユーザーのid AND Deals:status != 削除 AND フィルター条件
> フィルターはAND条件とする。
> 取得範囲は、page_number・page_sizeを元に取得する。
> レコードの並びは応募日時、カテゴリーの昇順とする。

ビジネスマッチング登録を取得する。

> 条件: 取得した案件が参照しているビジネスマッチング登録

**_出力項目_**

| 種別   | 論理名       | 物理名           | 型           | 内容                                     | 特記事項                           |
| :----- | :----------- | :--------------- | :----------- | :--------------------------------------- | :--------------------------------- |
| FORM   | 種別         | filter_type      | 選択肢       | 入力項目                                 |
| FORM   | カテゴリー   | filter_category  | 選択肢       | 入力項目                                 |
| FORM   | タイトル     | filter_title     | 文字列       | 入力項目                                 |
| FORM   | 開始日       | filter_start     | 日付         | 入力項目                                 |
| FORM   | 終了日       | filter_end       | 日付         | 入力項目                                 |
| BUTTON | 絞り込み     | button_filer     |
| BUTTON | リセット     | button_reset     |
| DISP   | 状態         | status           | 文字列       | 案件の項目                               |
| DISP   | 種別         | type             | 文字列       | ビジネスマッチング登録の項目             |
| DISP   | カテゴリー   | category         | 文字列       | ビジネスマッチング登録の項目             |
| LINK   | タイトル     | title            | 文字列       | ビジネスマッチング登録の項目             | 作成日から7日以内の場合、Newを表示 |
| DISP   | 応募金額     | pay              | カンマ文字列 | 案件の項目                               |
| DISP   | 内容         | description      | 文字列       | ビジネスマッチング登録の項目             | 書式=YYYY/mm/dd                    |
| DISP   | 依頼者       | requester        | 文字列       | ビジネスマッチング登録の項目(created_by) | 書式=YYYY/mm/dd                    |
| DISP   | 応募者       | applicant        | 文字列       | 案件の項目(created_by)                   | 書式=YYYY/mm/dd                    |
| DISP   | 応募日時     | applied_at       | 日時文字列   | 案件の項目(created_at)                   | 書式=YYYY/mm/dd HH:MM              |
| DISP   | 開始番号     | page_rec_start   | 整数文字列   | レコードの開始番号                       |
| DISP   | 終了番号     | page_rec_end     | 整数文字列   | レコードの終了番号                       |
| DISP   | レコード件数 | total_rec_number | 整数文字列   | レコード件数                             |
| LINK   | ページ番号   | page_number      | 整数文字列   | 前後2ページ分を表示                      |

**_アクション：絞り込み_**

再表示を行う。

**_アクション：リセット_**

フィルター項目に初期値をセットし、再表示を行う。

**_アクション：タイトル_**

遷移先の画面を表示する。

**_アクション：ページ番号_**

指定されたページを表示する。

### 2.6.5. 案件編集

**_入力項目_**

|  種別  | 論理名     | 物理名 | 型         | 内容         | 特記事項         |
| :----: | :--------- | :----- | :--------- | :----------- | :--------------- |
| SYSTEM | ユーザーID | uid    | 文字列     | ユーザーID   | ログインユーザー |
| PARAMS | レコードID | rid    | 整数文字列 | レコードのID |

> 一覧画面へ戻るための条件として、ページ間で下記の項目が必要となる。
>
> - pathname
> - filter_type
> - filter_category
> - filter_title
> - filter_start
> - filter_end
> - page_number

**_処理内容_**

ユーザーを取得する。

> 条件: Employees:email == uid AND (Users:start_on <= 実行日 <= Users:end_on)

案件を取得する。

> 条件: Deals:id == rid

ビジネスマッチング登録を取得する。

> 条件: 取得した案件が参照しているビジネスマッチング登録

コメントを取得する。

> 条件: 取得した案件を参照しているコメント

**_出力項目_**

| 種別   | 論理名           | 物理名         | 型       | 内容                                     | 特記事項                 |
| :----- | :--------------- | :------------- | :------- | :--------------------------------------- | :----------------------- |
| FORM   | 状態             | status         | 選択肢   | 案件の項目                               | 非活性                   |
| FORM   | 種別             | type           | 選択肢   | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | カテゴリー       | category       | 選択肢   | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | タイトル         | title          | 文字列   | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | 予算             | budget         | 整数     | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | 期限             | expired_on     | 日付     | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | 依頼者           | requester      | 選択肢   | ビジネスマッチング登録の項目(created_by) | 非活性                   |
| FORM   | 依頼日時         | requested_at   | 日時     | ビジネスマッチング登録の項目(created_at) | 非活性                   |
| FORM   | 内容             | description    | テキスト | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | 添付ファイル     | attachment     | ファイル | ビジネスマッチング登録の項目             | 非活性                   |
| FORM   | 応募金額         | pay            | 整数     | 案件の項目                               | 状態別項目表示方法を参照 |
| FORM   | 応募者           | applicant      | 選択肢   | 案件の項目(created_by)                   | 非活性                   |
| FORM   | 応募日時         | applied_at     | 日時     | 案件の項目(created_at)                   | 非活性                   |
| FORM   | 発注日時         | ordered_at     | 日時     | 案件の項目                               | 状態別項目表示方法を参照 |
| FORM   | 検収予定日       | accepting_on   | 日付     | 案件の項目                               | 状態別項目表示方法を参照 |
| FORM   | 受注日時         | confirmed_at   | 日時     | 案件の項目                               | 状態別項目表示方法を参照 |
| BUTTON | 変更             | button_update  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 発注             | button_update  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 受注             | button_update  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 完了             | button_update  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 辞退             | button_update  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 取消             | button_delete  |          |                                          | 状態別項目表示方法を参照 |
| BUTTON | 戻る             | button_back    |
| DISP   | コメント日時     | commented_at   | 日時     | コメントの項目                           |                          |
| DISP   | コメントユーザー | commented_by   | 文字列   | コメントの項目                           |                          |
| DISP   | コメントテキスト | commented_text | テキスト | コメントの項目                           |                          |
| FORM   | コメント         | comment        | テキスト |
| BUTTON | コメント追加     | button_comment |

**_状態別項目表示方法_**

| 状態   | 項目       | 依頼者(発注者) | 応募者(受注者) |
| :----- | :--------- | :------------: | :------------: |
| 応募   | 応募金額   |     非活性     |      活性      |
|        | 発注日時   |     非表示     |     非表示     |
|        | 検収予定日 |     非表示     |     非表示     |
|        | 受注日時   |     非表示     |     非表示     |
|        | 変更       |     非表示     |      表示      |
|        | 発注       |      表示      |     非表示     |
|        | 受注       |     非表示     |     非表示     |
|        | 完了       |     非表示     |     非表示     |
|        | 辞退       |     非表示     |     非表示     |
|        | 取消       |     非表示     |      表示      |
| 発注   | 応募金額   |     非活性     |     非活性     |
|        | 発注日時   |     非活性     |     非活性     |
|        | 検収予定日 |     非活性     |     非活性     |
|        | 受注日時   |     非表示     |     非表示     |
|        | 変更       |     非表示     |     非表示     |
|        | 発注       |     非表示     |     非表示     |
|        | 受注       |     非表示     |      表示      |
|        | 完了       |     非表示     |     非表示     |
|        | 辞退       |     非表示     |     非表示     |
|        | 取消       |      表示      |     非表示     |
| 受注   | 応募金額   |     非活性     |     非活性     |
|        | 発注日時   |     非活性     |     非活性     |
|        | 検収予定日 |     非活性     |     非活性     |
|        | 受注日時   |     非活性     |     非活性     |
|        | 変更       |     非表示     |     非表示     |
|        | 発注       |     非表示     |     非表示     |
|        | 受注       |     非表示     |     非表示     |
|        | 完了       |      表示      |     非表示     |
|        | 辞退       |      表示      |     非表示     |
|        | 取消       |     非表示     |      表示      |
| その他 | 応募金額   |     非活性     |     非活性     |
|        | 発注日時   |     非活性     |     非活性     |
|        | 検収予定日 |     非活性     |     非活性     |
|        | 受注日時   |     非活性     |     非活性     |
|        | 変更       |     非表示     |     非表示     |
|        | 発注       |     非表示     |     非表示     |
|        | 受注       |     非表示     |     非表示     |
|        | 完了       |     非表示     |     非表示     |
|        | 辞退       |     非表示     |     非表示     |
|        | 取消       |     非表示     |     非表示     |

**_アクション：変更_**

案件を更新する。

**_アクション：発注_**

案件を更新する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 発注

受注者へメールを送信する。

**_アクション：受注_**

案件を更新する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 受注

発注者へメールを送信する。

**_アクション：完了_**

案件を更新する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 完了

発注者・受注者へメールを送信する。

**_アクション：辞退_**

案件を更新する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 辞退

発注者・受注者へメールを送信する。

**_アクション：取消_**

案件を更新する。

> 案件の状態は下記の通りに設定する。
>
> - Deals:status = 一つ前の状態

発注者・受注者へメールを送信する。

**_アクション：戻る_**

遷移先の画面を表示する。

**_アクション：コメント追加_**

commentが入力されている場合、コメントを作成する。
発注者・受注者へメールを送信する。

## 2.7. マスター管理

### 2.7.1. グループ

### 2.7.2. ユーザー

### 2.7.3. 関与先

## 2.8. システム管理

<!-- pagebreak -->

# 3. データ設計

## 3.1. テーブル

テーブル定義書参照。

## 3.2. ファイル

### 3.2.1. 全体進捗明細CSVファイル

### 3.2.2. 個社別進捗明細CSVファイル

### 3.2.3. 担当者別進捗明細CSVファイル
